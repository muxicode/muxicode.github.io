---
title: ä½è¿ç®—-3-äºŒè¿›åˆ¶å®ç°åŠ å‡ä¹˜é™¤
autoGroup-1: ğŸŒ±é˜¶æ®µä¸€ï¼šåˆå‡ºèŒ…åºğŸŒ±
---

# 2.äºŒè¿›åˆ¶å®ç°åŠ å‡ä¹˜é™¤

## é¢˜ç›®ï¼š

è¦æ±‚ä½¿ç”¨ä½è¿ç®—å®ç°åŠ å‡ä¹˜é™¤ï¼Œå®ç°è¿‡ç¨‹ä¸­ä¸å…è®¸å‡ºç° +ï¼Œ -ï¼Œ *ï¼Œ / çš„è®¡ç®—è¡¨è¾¾å¼ï¼Œåªèƒ½ä½¿ç”¨ä½è¿ç®—ã€‚

[åŠ›æ‰£åŸé¢˜è¿æ¥](https://leetcode.cn/problems/divide-two-integers/description/)

## è§£æï¼š

### åŠ æ³•æ€è·¯ï¼š

> è·å–è¿›ä½çš„å€¼

å‡è®¾ a ï¼Œ b çš„å€¼å¦‚å›¾ï¼š

![image-20230319114923019](/2_binary_calc.assets/image-20230319114923019.png)

æˆ‘ä»¬è§‚å¯Ÿ a & b çš„ç»“æœï¼Œç”±äºæ˜¯aï¼Œbç›¸åŒä½ç½®éƒ½ä¸º1çš„æ—¶å€™å–1ã€‚

a + b çš„è¯ç›¸åŒä½ç½®ä¸º1ï¼Œåˆ™å½“å‰ä½ç½®ä¸º0ï¼Œè¿›ä½ä¸º1ã€‚

æ‰€ä»¥æˆ‘ä»¬å°† a & b å·¦ç§» 1ä½ï¼Œå³å¯å¾—åˆ° a + b çš„è¿›ä½éƒ¨åˆ†çš„å€¼ã€‚

> å½“å‰ä½ç½®çš„å€¼

![image-20230319130210020](/2_binary_calc.assets/image-20230319130210020.png)

æˆ‘ä»¬è§‚å¯Ÿ a ^ b çš„ç»“æœï¼Œç”±äºæ˜¯aï¼Œbç›¸åŒä½ç½®éƒ½ä¸åŒçš„æ—¶å€™å–1ã€‚

a + b çš„è¯ç›¸åŒä½ç½®å¦‚æœä¸åŒçš„è¯ï¼Œåªèƒ½æ˜¯0å’Œ1ï¼Œåˆ™ä¿ç•™1ã€‚

æ‰€ä»¥æˆ‘ä»¬å°† a ^ b ï¼Œå³å¯å¾—åˆ° a + b çš„ä¸åŒ…å«è¿›ä½çš„å€¼ã€‚

> ä»£ç 

```go
// é€’å½’å†™æ³•
func Sum(a, b int) int {
    // å½“aç­‰äº0æ—¶ï¼Œç›´æ¥è¿”å›b
	if a == 0 {
		return b
	}
    // è®°å½•ä¸‹åŸæ¥Açš„å€¼
	cacheA := a
    // æ±‚å‡ºè¿›ä½çš„å€¼
	a = (a & b ) << 1
    // æ±‚å‡ºä¸åŒ…å«å³ä¸ºçš„å€¼
	b ^= cacheA
    // ç»§ç»­æ±‚å’Œï¼Œè®©è¿›ä½ä½ä¸€ç›´å·¦ç§»ï¼Œç›´åˆ°å˜æˆ0ï¼Œå¾—åˆ°ç»“æœè¿”å›
	return Sum(a, b)
}

// éé€’å½’å†™æ³•
func Sum2(a, b int) int {
	var cacheA int
	for a != 0 {
		cacheA = a
		a = (a & b ) << 1
		b ^= mid
	}
	return b
}
```

### å‡æ³•æ€è·¯ï¼š

æˆ‘ä»¬ç›´åˆ° a - b ç­‰ä»·äº a + ï¼ˆ-bï¼‰ï¼Œé‚£åœ¨è®¡ç®—æœºä¸­ï¼Œæˆ‘ä»¬æ€ä¹ˆè¡¨è¾¾å–ç›¸åæ•°å‘¢ï¼Ÿæˆ‘ä»¬å…ˆä½¿ç”¨ [1.intç±»å‹çš„äºŒè¿›åˆ¶ç ](./1_get_binary)
æ‰“å°ä¸€ä¸‹1çš„äºŒè¿›åˆ¶è¡¨è¾¾ï¼š

![image-20230319150309017](/2_binary_calc.assets/image-20230319150309017.png)

æˆ‘ä»¬å‘ç°ï¼š-1 çš„äºŒè¿›åˆ¶ç  ç­‰äº 1å–ååŠ 1ã€‚

å…¶å®åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­,æ•°å€¼ä¸€å¾‹ç”¨è¡¥ç æ¥è¡¨ç¤ºå’Œå­˜å‚¨ã€‚åŸå› åœ¨äº,ä½¿ç”¨è¡¥ç ,å¯ä»¥å°†ç¬¦å·ä½å’Œæ•°å€¼åŸŸç»Ÿä¸€å¤„ç†;åŒæ—¶,åŠ æ³•å’Œå‡æ³•ä¹Ÿå¯ä»¥ç»Ÿä¸€å¤„ç†ã€‚å¥½å¤„æ—¶å¯ä»¥åŠ å¿«è®¡ç®—æœºã€‚æƒ³è¦ç›´åˆ°å…·ä½“çš„åŸç†å¯ä»¥å‚è€ƒ[è¡¥ç ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿ](https://blog.csdn.net/Tian_JT/article/details/128358374)ã€‚

æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰å®ç°çš„åŠ æ³•å‡½æ•°ï¼Œå®ç°å‡æ³•ï¼š

```go
func Reduce(a, b int) int {
	return Sum(a, Invert(b))
}

// å–å
func Invert(num int) int {
    return Sum2(^num, 1)
}
```

æµ‹è¯• 10 - 5ï¼š 

![image-20230319154022242](/2_binary_calc.assets/image-20230319154022242.png)

### ä¹˜æ³•æ€è·¯ï¼š

 ![image-20230319202802840](/2_binary_calc.assets/image-20230319202802840.png)

ä¸Šå›¾ç»™å‡ºäº† 3 * 3 äºŒè¿›åˆ¶ä¹˜æ³•çš„å…·ä½“çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬é‡‡ç”¨ä¹˜æ³•ç«–å¼ï¼Œå¯ä»¥å¾—å‡ºæ¯ä½ç›¸ä¹˜çš„ç»“æœï¼Œæœ€åç´¯åŠ ï¼Œå³åˆ»å¾—å‡ºç­”æ¡ˆ9çš„äºŒè¿›åˆ¶ã€‚

æˆ‘ä»¬æƒ³è¾¾åˆ°ä¸ä¹˜æ³•ç«–å¼ç›¸åŒçš„ç»“æœå¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹å¼ï¼š

1. åˆå§‹åŒ– ç­”æ¡ˆ Ans ç­‰äº0ï¼Œè¢«ä¹˜æ•°å·¦ç§»0ä½ï¼Œä¹˜æ•°ä¸1å·¦ç§»0ä½ç›¸ä¸ä¸ç­‰äº0ï¼Œåˆ™æ ¹æ®ä¹˜æ³•ç«–å¼ï¼ŒAnséœ€è¦åŠ ä¸Šæ­¤æ—¶çš„å·¦ç§»0ä½çš„è¢«ä¹˜æ•°3.

![image-20230319210126168](/2_binary_calc.assets/image-20230319210126168.png)

2. è¢«ä¹˜æ•°å·¦ç§»1ä½ï¼Œä¹˜æ•°ä¸1å·¦ç§»1ä½ç›¸ä¸ä¸ç­‰äº0ï¼Œåˆ™æ ¹æ®ä¹˜æ³•ç«–å¼ï¼ŒAnséœ€è¦åŠ ä¸Šæ­¤æ—¶çš„å·¦ç§»1ä½çš„è¢«ä¹˜æ•°3.

![image-20230319220818107](/2_binary_calc.assets/image-20230319220818107.png)

3. è¢«ä¹˜æ•°å·¦ç§»2ä½ï¼Œä¹˜æ•°ä¸1å·¦ç§»2ä½ç›¸ä¸ä¸ç­‰äº0ï¼Œåˆ™æ ¹æ®ä¹˜æ³•ç«–å¼ï¼ŒAnséœ€è¦åŠ ä¸Šæ­¤æ—¶çš„å·¦ç§»2ä½çš„è¢«ä¹˜æ•°6.

![image-20230319220935861](/2_binary_calc.assets/image-20230319220935861.png)

4. è¢«ä¹˜æ•°å·¦ç§»3ä½ï¼Œä¹˜æ•°ä¸1å·¦ç§»3ä½ç›¸ä¸ç­‰äº0ï¼Œåˆ™æ ¹æ®ä¹˜æ³•ç«–å¼ï¼ŒAnséœ€è¦åŠ ä¸Š0ï¼ŒAnsä¸å˜

![image-20230319221045130](/2_binary_calc.assets/image-20230319221045130.png)

å¾—å‡ºAns = 9. ä»¥ä¸Šä»¥4ä½çš„äºŒè¿›åˆ¶çš„æ­£æ•°ä½œä¸ºä¾‹å­ï¼Œå®é™…å®ç°ä¹˜æ³•çš„æ—¶å€™ï¼Œéœ€è¦è€ƒè™‘æ­£è´Ÿæ•°ã€‚

é€šè¿‡è§‚å¯Ÿå…¶å®ï¼Œåªè¦ä¿è¯ä¹˜æ•°å·¦ç§»çš„æ—¶å€™ä¸å°†ç¬¦å·æ•°å·¦ç§»å³å¯ï¼Œjavaä¸­æœ‰æ— ç¬¦å·å·¦ç§»ï¼Œæ‰€ä»¥åœ¨javaä¸­æ— éœ€ç‰¹æ®Šå¤„ç†ï¼Œä½†æ˜¯ç”±äºåœ¨goä¸­æ²¡æœ‰æ— ç¬¦å·å·¦ç§»ï¼Œæ‰€ä»¥åœ¨goä¸­ï¼Œå¦‚æœä¹˜æ•°æ˜¯è´Ÿæ•°ï¼Œéœ€è¦å°†ä¹˜æ•°å–åè¿›è¡Œè®¡ç®—ï¼Œæœ€åçš„æ—¶å€™è¿˜åŸç¬¦å·è¿”å›å³å¯ã€‚

> ä»£ç 

```go
// é€’å½’ç‰ˆæœ¬
func MultiplyProcess(a, b, ans int) int {
	// å½“ä¹˜æ•°ä¸º0æ—¶ï¼Œåˆ™å·²ç»è·å–åˆ°äº†æ‰€æœ‰çš„ç´¯åŠ å’Œ
	if b == 0 {
		return ans
	}
	// å¦‚æœbå°äº0ï¼Œéœ€è¦å–åè¿›è¡Œè®¡ç®—
	bLessZero := false
	if b < 0 {
		bLessZero = true
		b = Invert(b)
	}
	// å½“å‰ä½ç½®ä¸ç­‰äº0ï¼Œç´¯åŠ ç»“æœ
	if b & 1 != 0 {
		ans = Sum2(ans, a)
	}
	// è¢«ä¹˜æ•°å·¦ç§»
	a <<= 1
	// ä¹˜æ•°å³ç§»
	b >>= 1
	// æ¢å¤è®¡ç®—ç°åœº
	if bLessZero {
		b = Invert(b)
		ans = Invert(ans)
	}
	return MultiplyProcess(a, b, ans)
}


// è¿­ä»£ç‰ˆæœ¬
func Multiply2(a, b int) int {
	bLessZero := false
	if b < 0 {
		bLessZero = true
		b = Invert(b)
	}
	ans := 0
	for b != 0 {
		if b & 1 != 0 {
			ans += a
		}
		a <<= 1
		b >>= 1
	}
	if bLessZero {
		return Invert(ans)
	}
	return ans
}
```



### é™¤æ³•æ€è·¯ï¼š

é‡‡ç”¨é™¤æ³•ç«–å¼çš„æ€è·¯ï¼Œæˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥çš„ç¡®å®šæˆ‘ä»¬ç»“æœæ¯ä¸€ä¸ªä½ç½®ä¸Šæ˜¯å»0è¿˜æ˜¯å–1ï¼Œé€šè¿‡ç§»ä½å¹¶å¯¹æ¯”åšå‡æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°é™¤æ³•çš„ç­”æ¡ˆï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š

![image-20230320001554457](/2_binary_calc.assets/image-20230320001554457.png)

æˆ‘ä»¬ä»¥ 4ä½çš„äºŒè¿›åˆ¶é™¤æ³• åšäº†æˆ‘ä»¬çš„ä¾‹å­ï¼ŒåŒè¿‡ä¸Šè¿°æ€è·¯æˆ‘ä»¬ï¼Œå¯ä»¥åˆæ­¥ç¡®å®šæˆ‘ä»¬çš„ä»£ç é€»è¾‘ï¼Œä½†æ˜¯è¿˜éœ€è¦æ³¨æ„ï¼Œåœ¨é™¤æ³•ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ¯”è¾ƒä¸¤æ•°å¤§å°ï¼Œå¦‚æœå¸¦ä¸Šç¬¦å·ä½ï¼Œåœ¨æœ‰æ­£è´Ÿçš„æƒ…å†µä¸‹æˆ‘ä»¬ä¸å¥½åšå¯¹æ¯”ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†ä¸¤ä¸ªæ•°éƒ½è½¬ä¸ºæ­£æ•°ï¼Œæœ€åæ ¹æ®åŸæ¥çš„å€¼å†³å®šæ˜¯å¦éœ€è¦ä¿®æ”¹ç¬¦å·è¿”å›ã€‚

ç”±äºè´Ÿæ•°åœ¨äºŒè¿›åˆ¶æ€»æ¯”è¡¨è¾¾æ­£æ•°çš„æ•°å¤šä¸€ä¸ªå¦‚äºŒä½çš„äºŒè¿›åˆ¶ï¼š00->[0] ï¼Œ01->[1] ï¼Œ10->[-2] ï¼Œ11->[-1] ã€‚æˆ‘ä»¬è¿˜éœ€è¦æ³¨æ„ä¸€ä¸‹å‡ ç§æƒ…å†µï¼Œå¦‚ï¼š-2 / -1  åŸåˆ™ä¸Š -2/-1 ç­‰äº 2ï¼Œä½†æ˜¯ç”±äºæˆ‘ä»¬çš„æœ€å¤§å€¼æ˜¯1ï¼Œæˆ‘ä»¬æ— æ³•æœ‰2è¿™ä¸ªå€¼ã€‚æˆ‘ä»¬è¿˜è®¤ä¸ºæœ€å°å€¼é™¤ä»¥-1ç­‰äºæœ€å¤§å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¤ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹ -2/-1 = 1

å¦ä¸€ç§æƒ…å†µï¼šå‡è®¾æˆ‘ä»¬ç°åœ¨åªæœ‰ä¸‰ä½äºŒè¿›åˆ¶æ•°ï¼Œ0000 -> 1111 ï¼Œåˆ™æˆ‘ä»¬èƒ½è¡¨ç¤ºçš„æ•°å­—æ˜¯ -8 -> 7 ä¹‹é—´çš„æ•°ï¼Œæ­¤æ—¶ -8/2 = -4ï¼Œç”±äºæˆ‘ä»¬ç®—é™¤æ³•çš„æ—¶å€™ï¼Œéœ€è¦å¯¹ -8 -> [1000] å–ååŠ 1 å˜æˆ [0111] -> 7 ï¼Œæ­¤æ—¶ 7/2 = 3ï¼Œä¸é¢„æœŸå°‘äº†1ã€‚

æ‰€ä»¥ï¼Œåœ¨è¢«é™¤æ•°ä¸ºæœ€å°çš„æ—¶å€™ï¼Œå¦‚ï¼š-8 / 2 çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä½¿ç”¨ (-8 + 1)/2  å¾—åˆ° -3ï¼Œæˆ‘ä»¬å°† -3 * 2 = -6ï¼Œæ­¤æ—¶ -8 - ï¼ˆ-6 ï¼‰= -2ï¼Œç”¨ -2 / 2 = -1ï¼Œæ­¤æ—¶å°†å·®å€¼ -1 + (-3) = -4ï¼Œæ­¤æ—¶å¯ä»¥å¾—åˆ°æ­£ç¡®ç»“æœã€‚

æˆ‘ä»¬é€šè¿‡å›¾ç¤ºçš„æ–¹å¼å¯ä»¥è®¡ç®—å‡ºç»“æœï¼Œä½†æ˜¯æœ‰ç‰¹æ®Šæƒ…å†µå¦‚ä¸‹ï¼š

![image-20230322000641279](/2_binary_calc.assets/image-20230322000641279.png)

æˆ‘ä»¬å‘ç°ï¼Œä½¿ç”¨é™¤æ•°å·¦ç§»ï¼Œå®¹æ˜“è¶…å‡ºä¸Šé™ï¼Œå¯¼è‡´å¾—åˆ°é”™è¯¯çš„ç»“æœã€‚

æ‰€ä»¥æˆ‘ä»¬å®é™…ä½¿ç”¨è¢«é™¤æ•°å·¦ç§»ï¼Œä»ä¸Šé™ç§»åŠ¨åˆ°0ä½ã€‚

![image-20230322001200312](/2_binary_calc.assets/image-20230322001200312.png)

> ä»£ç 

```go
func divide(dividend int, divisor int) int {
	if divisor == math.MinInt32 && dividend == math.MinInt32 { 
        // ä¸ºä»€ä¹ˆæ˜¯ math.MinInt32 ä¸ºæœ€å°å€¼ï¼Ÿå› ä¸ºåŠ›æ‰£é‡‡ç”¨çš„æ˜¯int32åšçš„æµ‹è¯•ç”¨ä¾‹
        // æœ€å°å€¼é™¤æœ¬èº«ç­‰äº 1
		return 1
	} else if divisor == math.MinInt32 {
        // divisor ä¸ºç³»ç»Ÿæœ€å°æ—¶ é™¤äº†ç›¸ç­‰çš„æ—¶å€™éƒ½æ˜¯0
		return 0
	} else if dividend == math.MinInt32 {
		if divisor == Invert(1) {
			return math.MaxInt32
		}
		ans := Div2(dividend, divisor)
		return Sum2(ans, Div2(Reduce(dividend, Multiply2(ans, divisor)), divisor))
	}
	return Div2(dividend, divisor)
}


func Div2(a, b int) int {
	isALessZero, isBLessZero := false, false
	if a < 0 {
		isALessZero = true
		a = Invert(a)
	}
	if b < 0 {
		isBLessZero = true
		b = Invert(b)
	}
	ans := 0
	for i:=62; i>=0; i-- {
        // é‡‡ç”¨ a å³ç§» i ä½
		if (a >> i) >= b {
			ans |= 1<<i
			a = Reduce(a, b<<i)
		}
	}
	if isALessZero && isBLessZero {
		return ans
	} else if isALessZero || isBLessZero {
		return Invert(ans)
	}
	return ans
}
```



## å®Œæ•´ä»£ç ï¼š

å¯æ‹·è´åˆ°åŠ›æ‰£ç½‘ç«™ç›´æ¥æ‰§è¡Œé€šè¿‡ï¼Œå·²éªŒè¯ã€‚[åŠ›æ‰£åŸé¢˜è¿æ¥](https://leetcode.cn/problems/divide-two-integers/description/)

```go
import "math"

func Sum(a, b int) int {
	if a == 0 {
		return b
	}
	cache := a
	a = (a & b ) << 1
	b ^= cache
	return Sum(a, b)
}

func Sum2(a, b int) int {
	var mid int
	for a != 0 {
		mid = a
		a = (a & b ) << 1
		b ^= mid
	}
	return b
}

func Reduce(a, b int) int {
	return Sum(a, Invert(b))
}

func Invert(num int) int {
	return Sum2(^num, 1)
}

func MultiplyProcess(a, b, ans int) int {
	// å½“ä¹˜æ•°ä¸º0æ—¶ï¼Œåˆ™å·²ç»è·å–åˆ°äº†æ‰€æœ‰çš„ç´¯åŠ å’Œ
	if b == 0 {
		return ans
	}
	// å¦‚æœbå°äº0ï¼Œéœ€è¦å–åè¿›è¡Œè®¡ç®—
	bLessZero := false
	if b < 0 {
		bLessZero = true
		b = Invert(b)
	}
	// å½“å‰ä½ç½®ä¸ç­‰äº0ï¼Œç´¯åŠ ç»“æœ
	if b & 1 != 0 {
		ans = Sum2(ans, a)
	}
	// è¢«ä¹˜æ•°å·¦ç§»
	a <<= 1
	// ä¹˜æ•°å³ç§»
	b >>= 1
	// æ¢å¤è®¡ç®—ç°åœº
	if bLessZero {
		b = Invert(b)
		ans = Invert(ans)
	}
	return MultiplyProcess(a, b, ans)
}

func Multiply2(a, b int) int {
	bLessZero := false
	if b < 0 {
		bLessZero = true
		b = Invert(b)
	}
	ans := 0
	for b != 0 {
		if b & 1 != 0 {
			ans += a
		}
		a <<= 1
		b >>= 1
	}
	if bLessZero {
		return Invert(ans)
	}
	return ans
}

func divide(dividend int, divisor int) int {
	if divisor == math.MinInt32 && dividend == math.MinInt32 {
		return 1
	} else if divisor == math.MinInt32{
		return 0
	} else if dividend == math.MinInt32 {
		if divisor == Invert(1) {
			return math.MaxInt32
		}
		ans := Div2(dividend, divisor)
		return Sum2(ans, Div2(Reduce(dividend, Multiply2(ans, divisor)), divisor))
	}
	return Div2(dividend, divisor)
}


func Div2(a, b int) int {
	isALessZero, isBLessZero := false, false
	if a < 0 {
		isALessZero = true
		a = Invert(a)
	}
	if b < 0 {
		isBLessZero = true
		b = Invert(b)
	}
	ans := 0
	for i:=62; i>=0; i-- {
		if (a >> i) >= b {
			ans |= 1<<i
			a = Reduce(a, b<<i)
		}
	}
	if isALessZero && isBLessZero {
		return ans
	} else if isALessZero || isBLessZero {
		return Invert(ans)
	}
	return ans
}
```


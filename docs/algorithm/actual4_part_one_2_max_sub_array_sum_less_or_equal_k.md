---
title: ç´¯åŠ å’Œå°äºç­‰äºk
autoGroup-5: ğŸ“’ç»ƒä¹ é›†ğŸ“’
---

# ç´¯åŠ å’Œå°äºç­‰äºk

## é¢˜ç›®

  ç»™å®šä¸€ä¸ªæ•°ç»„arrï¼Œå†ç»™å®šä¸€ä¸ªkå€¼ï¼Œè¿”å›ç´¯åŠ å’Œå°äºç­‰äºkï¼Œä½†æ˜¯ç¦» k æœ€è¿‘çš„å­æ•°ç»„çš„ç´¯åŠ å’Œã€‚

## æ€è·¯ï¼š

â€‹	å¯¹äº arr:  [.... i ....]ï¼Œæ¯ä¸€ä¸ª i ä½ç½®ï¼Œéå†æ¯ä¸€ä¸ª ä»¥ i ç»“å°¾ï¼Œçš„å­æ•°ç»„çš„ç´¯åŠ å’Œæ˜¯å¦å°äºç­‰äºkï¼Œå¦‚æœå°äºåˆ™ä¸å½“å‰æ”¶é›†çš„ç­”æ¡ˆè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå¤§äºåˆ™è®°å½•å½“å‰å€¼ä¸ºç­”æ¡ˆã€‚

> åŠ é€Ÿï¼š	

é‡‡ç”¨æœ‰åºè¡¨ï¼Œè®°å½•æ¯ä¸€ä¸ªå‰ç¼€å’Œï¼Œå°†å‰ç¼€å’Œæ·»åŠ åˆ°æœ‰åºè¡¨ä¸­ï¼Œå¦‚æœ æœ‰åºè¡¨ä¸­å­˜åœ¨å¤§äºç­‰äºkçš„å‰ç¼€å’Œï¼Œåˆ™ä»¥å½“å‰ä½ç½®ä¸ºç»“å°¾çš„å­æ•°ç»„ä¸­ï¼Œå­˜åœ¨å°äºç­‰äºkçš„å­æ•°ç»„å’Œï¼Œå°†è¯¥å€¼è®°å½•ä¸‹æ¥ã€‚

> æ³¨æ„ï¼šä¾èµ– github.com/emirpasic/gods è¿™ä¸ªåº“ï¼Œè¯¥åº“åŒ…å«å¤šç§æ•°æ®ç»“æ„
> ç”±äº golang å¹¶æ²¡æœ‰å†…ç½®çš„æœ‰åºè¡¨ï¼Œæ‰€ä»¥ä½¿ç”¨ç¬¬ä¸‰æ”¾å†™å¥½çš„æ•°æ®ç»“

```go
import (
	rbt "github.com/emirpasic/gods/trees/redblacktree"
	"traning/algorithm/utility/mymath"
)

/*
	ç»™å®šä¸€ä¸ªæ•°ç»„arrï¼Œå†ç»™å®šä¸€ä¸ªkå€¼ï¼Œè¿”å›ç´¯åŠ å’Œå°äºç­‰äºkï¼Œä½†æ˜¯ç¦»
	k æœ€è¿‘çš„å­æ•°ç»„ç´¯åŠ å’Œã€‚

	æ€è·¯ï¼š
		[.... i ....]
		éå†æ¯ä¸€ä¸ª i ä½ç½®ï¼Œéå†æ¯ä¸€ä¸ª ä»¥ i ç»“å°¾ï¼Œçš„å­æ•°ç»„çš„ç´¯åŠ å’Œ
		æ˜¯å¦å°äºç­‰äºkï¼Œå¦‚æœå°äºåˆ™æ”¶é›†èµ·æ¥ï¼Œä¸ç­”æ¡ˆè¿›è¡Œpk

		åŠ é€Ÿï¼š
			é‡‡ç”¨æœ‰åºè¡¨ï¼Œè®°å½•æ¯ä¸€ä¸ªå‰ç¼€å’Œï¼Œå°†å‰ç¼€å’Œæ·»åŠ åˆ°æœ‰åºè¡¨ä¸­ï¼Œ
			å¦‚æœ æœ‰åºè¡¨ä¸­å­˜åœ¨å¤§äºç­‰äºkçš„å‰ç¼€å’Œï¼Œåˆ™ä»¥å½“å‰ä½ç½®ä¸ºç»“å°¾
			çš„å­æ•°ç»„ä¸­ï¼Œå­˜åœ¨å°äºç­‰äºkçš„å­æ•°ç»„å’Œï¼Œå°†è¯¥å€¼è®°å½•ä¸‹æ¥ã€‚

	æ³¨æ„ï¼šä¾èµ– github.com/emirpasic/gods è¿™ä¸ªåº“ï¼Œè¯¥åº“åŒ…å«å¤šç§æ•°æ®ç»“æ„
         ç”±äº golang å¹¶æ²¡æœ‰å†…ç½®çš„æœ‰åºè¡¨ï¼Œæ‰€ä»¥ä½¿ç”¨ç¬¬ä¸‰æ”¾å†™å¥½çš„æ•°æ®ç»“æ„
*/
func GetMaxLessOrEqualK(arr []int, k int) int {
	// è®°å½•iä¹‹å‰é‚£çš„å‰ç¼€å’ŒæŒ‰ç…§æœ‰åºè¡¨ç»„ç»‡
	tree := rbt.NewWithIntComparator()
	// è¡¨ç¤ºæ²¡æœ‰å…ƒç´ çš„æƒ…å†µä¸‹ï¼Œå‰ç¼€å’Œä¸º0
	tree.Put(0, 0)

	/*	sum [0 ... i] ä½ç½®çš„ç´¯åŠ å’Œ
		å¦‚æœï¼šå½“å‰æ€»å’Œä¸º 100 ï¼ŒKä¸º 20
		[0 ................   i ] sum
		[0 ................   i ]
		[ (>=sum-k) x (<=K)   i ]
	*/
	var sum, ans int
	// æ¯ä¸€æ­¥çš„iï¼Œéƒ½æ±‚å­æ•°ç»„å¿…é¡»ä»¥iç»“å°¾çš„æƒ…å†µä¸‹ï¼Œæ±‚ä¸ªå­æ•°ç»„çš„ç´¯åŠ å’Œï¼Œæ˜¯<=Kçš„ï¼Œå¹¶ä¸”æ˜¯æœ€å¤§çš„
	for i:=0; i<len(arr); i++ {
		sum += arr[i]
		if n, ok := tree.Ceiling(sum-k); ok {
			ans = mymath.Max(ans, sum - n.Key.(int))
		}
		tree.Put(sum, sum)
	}
	return ans
}
```

